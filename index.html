<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>CrossYTH Dashboard</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0f172a">

    <script src="https://cdn.tailwindcss.com"></script>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

    <style>
        body { background-color: #0f172a; color: white; font-family: sans-serif; -webkit-tap-highlight-color: transparent; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .safe-pb { padding-bottom: env(safe-area-inset-bottom); }
    </style>
</head>
<body>

    <div id="root" class="h-screen w-screen flex flex-col items-center justify-center">
        <div class="animate-pulse text-blue-400 font-bold tracking-widest">LOADING CROSSYTH...</div>
    </div>

    <script type="text/babel">
        // --- ERROR TRAP ---
        // If the app crashes, this will show the error on screen instead of white space.
        window.onerror = function(message, source, lineno, colno, error) {
            document.getElementById('root').innerHTML = `
                <div style="padding:20px; color:#ef4444; text-align:center;">
                    <h2 style="font-size:20px; font-weight:bold;">System Error</h2>
                    <p>${message}</p>
                    <p style="font-size:12px; opacity:0.7;">Line: ${lineno}</p>
                </div>
            `;
        };

        // --- 1. FIREBASE CONFIG ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, query, onSnapshot, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
          apiKey: "AIzaSyCWTjZ5P-cvfL3bgFOrl53qRQEfWP35ThE",
          authDomain: "crossyth-dashboard.firebaseapp.com",
          projectId: "crossyth-dashboard",
          storageBucket: "crossyth-dashboard.firebasestorage.app",
          messagingSenderId: "999386499044",
          appId: "1:999386499044:web:49e4bc10c133b4c20f29f1",
          measurementId: "G-YX6RZ0QCKM"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- 2. INTERNAL ICONS (SVG) ---
        // Hardcoded so they cannot fail to load
        const Icons = {
            Menu: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="4" y1="12" x2="20" y2="12"/><line x1="4" y1="6" x2="20" y2="6"/><line x1="4" y1="18" x2="20" y2="18"/></svg>,
            Home: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>,
            Book: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>,
            Calendar: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>,
            Plus: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>,
            X: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        };

        // --- 3. MAIN APP ---
        function App() {
            const [tab, setTab] = React.useState('dashboard');
            const [menuOpen, setMenuOpen] = React.useState(false);

            const renderContent = () => {
                switch(tab) {
                    case 'dashboard': return <Dashboard />;
                    case 'sermons': return <SermonManager />;
                    default: return <Dashboard />;
                }
            };

            return (
                <div className="flex flex-col h-screen w-full bg-slate-900 text-white overflow-hidden">
                    {/* Header */}
                    <div className="h-16 border-b border-slate-800 flex items-center justify-between px-4 shrink-0">
                        <div className="font-bold text-xl tracking-tight text-blue-500">CrossYTH</div>
                        <button onClick={() => setMenuOpen(!menuOpen)} className="p-2 active:bg-slate-800 rounded">
                            {menuOpen ? <Icons.X /> : <Icons.Menu />}
                        </button>
                    </div>

                    {/* Mobile Menu Overlay */}
                    {menuOpen && (
                        <div className="absolute top-16 left-0 w-full h-full bg-slate-900/95 z-50 p-6 flex flex-col gap-4">
                            <NavButton icon={<Icons.Home />} label="Dashboard" active={tab==='dashboard'} onClick={() => {setTab('dashboard'); setMenuOpen(false);}} />
                            <NavButton icon={<Icons.Book />} label="Sermons" active={tab==='sermons'} onClick={() => {setTab('sermons'); setMenuOpen(false);}} />
                        </div>
                    )}

                    {/* Main Content Area */}
                    <div className="flex-1 overflow-y-auto bg-slate-50 text-slate-900 relative">
                        {renderContent()}
                    </div>
                </div>
            );
        }

        // --- SUB-COMPONENTS ---
        
        function NavButton({icon, label, active, onClick}) {
            return (
                <button onClick={onClick} className={`flex items-center gap-4 p-4 rounded-xl text-lg font-medium transition-colors ${active ? 'bg-blue-600 text-white' : 'text-slate-400 hover:text-white'}`}>
                    {icon} {label}
                </button>
            )
        }

        function Dashboard() {
            return (
                <div className="p-6">
                    <h2 className="text-2xl font-bold mb-4 text-slate-800">Welcome Pastor Casey</h2>
                    <div className="grid grid-cols-2 gap-4 mb-6">
                        <div className="bg-blue-600 p-4 rounded-xl text-white shadow-lg">
                            <div className="text-3xl font-bold">3</div>
                            <div className="text-xs uppercase opacity-80">Upcoming</div>
                        </div>
                        <div className="bg-purple-600 p-4 rounded-xl text-white shadow-lg">
                            <div className="text-3xl font-bold">12</div>
                            <div className="text-xs uppercase opacity-80">Leaders</div>
                        </div>
                    </div>
                </div>
            );
        }

        function SermonManager() {
            const [items, setItems] = React.useState([]);
            const [loading, setLoading] = React.useState(true);

            // React.useEffect(() => {
            //     const q = query(collection(db, 'sermons'));
            //     const unsub = onSnapshot(collection(db, 'sermons'), (snap) => {
            //         const data = snap.docs.map(d => ({id:d.id, ...d.data()}));
            //         setItems(data);
            //         setLoading(false);
            //     });
            //     return () => unsub();
            // }, []);

            const addSermon = async () => {
                const t = prompt("Sermon Title:");
                if(t) {
                    await addDoc(collection(db, 'sermons'), {
                        title: t,
                        date: new Date().toISOString()
                    });
                }
            };

            return (
                <div className="p-6">
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-2xl font-bold text-slate-800">Sermons</h2>
                        <button onClick={addSermon} className="bg-slate-900 text-white p-2 rounded-full shadow-lg">
                            <Icons.Plus />
                        </button>
                    </div>
                    {/* Placeholder for list */}
                    <div className="text-center p-10 text-slate-400 border-2 border-dashed rounded-xl">
                        Sermon List Loading...
                    </div>
                </div>
            );
        }

        // --- INITIALIZE ---
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
